{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\n\nexport async function getPhotos(picture, page) {\n    const BASE_URL = 'https://pixabay.com/api/';\n    const API_KEY = '43303597-4cf3538acd20e5586f11f779c';\n    \n    const response = await axios.get(`${BASE_URL}`, {\n            params: {\n                key: API_KEY,\n                q: picture,\n                image_type: 'photo',\n                orientation: 'horizontal',\n                safesearch: true,\n                per_page: 15,\n                page: page,\n            }\n        })\n    console.log(response.data);\n        return response.data;\n    }\n    // catch (error) {\n    //     throw new Error(error.message);\n\n// }\n\n\n\n","\nexport function createMarkup(arr) {\n    return arr\n        .map(item => {\n            return `\n         <li class=\"galleryCard\">\n          <a href=\"${largeImageURL}\" class=\"lightbox-image\">\n            <img src=\"${webformatURL}\" alt=\"${tags}\" class=\"picture-icon\">\n          </a>\n\n          <div class=\"picture-info\">\n            \n          <div>\n              <span>Likes:</span>\n              <span class=\"likes\">${likes}</span>\n            </div>\n            \n            <div>\n              <span>Views:</span>\n              <span class=\"views\">${views}</span>\n            </div>\n            \n            <div>\n              <span>Comments:</span>\n              <span class=\"comments\">${comments}</span>\n            </div>\n           \n            <div>\n              <span>Downloads:</span>\n              <span class=\"downloads\">${downloads}</span>\n            </div>\n          </div>\n\n        </li>`\n        }).join('');\n\n}","`use strict`;\n\n// Library iziToast\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\n// Library SimpleLightbox\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\n// Import \nimport { getPhotos } from \"./js/pixabay-api\";\nimport { createMarkup } from \"./js/render-functions\";\n\n// querySelectors\nconst btnSubmit = document.getElementById(\"search-btn\");\nconst searchForm = document.getElementById(\"search-form\");\nconst searchInput = document.querySelector(\"[picture]\");\nconst searchGallery = document.getElementById(\"gallery\");\nconst btnLoadMore = document.querySelector(\".load-more-btn\");\n\nlet page = 1;\nlet currentQuery = null;\n\nsearchForm.addEventListener(\"submit\", handleSubmit);\n\nfunction clearMarkup() {\n  searchGallery.innerHTML = '';\n}\n\nbtnLoadMore.addEventListener('click', event => {\n  event.preventDefault();\n  handleLoadMore();\n});\n\nasync function handleSubmit(event) {\n    event.preventDefault();\n    searchGallery.innerHTML = ''\n  \n    currentQuery = event.currentTarget.elements['picture'].value.trim();\n\n    loader.style.display = \"block\";\n    \ntry {\n    const response = await getPhotos(currentQuery, page);\n        \n    if (response.results.length === 0) {\n        return iziToast.error({\n            message: \"Sorry, there are no images matching your search query. Please try again!\",\n        });\n    } else {\n        searchGallery.innerHTML = createMarkup(response.results);\n        // // toggleLoadButton(response.data);\n        // return response.data;\n        //     gallery.refresh();\n    }\n} catch (error) {\n\n    iziToast.error({\n        message: \"Error. Please try again!\"\n        });\n    clearMarkup();\n    \n} finally {\n            loader.style.display = \"none\";\n            searchForm.reset();\n}\n\n}\nconst gallery = new SimpleLightbox(`.galleryCard a`, {\n                    captionType: `attr`,\n                    captionsData: `alt`,\n                    captionDelay: 250,\n});\n\nasync function handleLoadMore() {\n  page += 1;\n  try {\n      const response = await getPhotos(currentQuery, page);\n      \n    if (response.results.length > 0) {\n      searchGallery.insertAdjacentHTML('beforeend', createMarkup(response.results));\n        // togglebtnLoadMore(response.totalHits);\n        \n        // Функія для скролу\n        \n        const {height: galleryCardHeight} = document.querySelector('.galleryCard')\n        .firstElementChild.getBoundingClientRect();\n      \n        window.scrollBy({\n        top: galleryCardHeight * 3,\n        behavior: 'smooth',\n        });\n        const lastPage = Math.ceil(response.total / 20);\n        if (lastPage === page) {\n            btnLoadMore.searchGallery.add('is-hidden');\n            return iziToast.info({\n               message: \"We're sorry, but you've reached the end of search results\"\n           })\n        }\n\n    } else {\n      iziToast.info({\n        title: 'Info',\n        message: 'No more images to load!',\n      });\n    }\n   \n    if (currentPage * 15 >= response.results) {\n      btnLoadMore.style.display = 'none';\n      iziToast.info({\n        title: 'End of search results',\n        message:\n          \"We're sorry, but you're nearing the end of the search results.\",\n      });\n    }\n  } catch (error) {\n    iziToast.error({\n      title: 'Error',\n      message:\n        'An error occurred while fetching more images. Please try again later!',\n    });\n  }\n}\n\nfunction toggleLoadButton(totalHits) {\n  if (currentPage * 15 < totalHits) {\n    btnLoadMore.style.display = 'block';\n  } else {\n    btnLoadMore.style.display = 'none';\n  }\n}\n                \n\n\n\n"],"names":["getPhotos","picture","page","BASE_URL","API_KEY","response","axios","createMarkup","arr","item","searchForm","searchGallery","btnLoadMore","currentQuery","handleSubmit","clearMarkup","event","handleLoadMore","iziToast","SimpleLightbox","galleryCardHeight"],"mappings":"owBAEO,eAAeA,EAAUC,EAASC,EAAM,CAC3C,MAAMC,EAAW,2BACXC,EAAU,qCAEVC,EAAW,MAAMC,EAAM,IAAI,GAAGH,CAAQ,GAAI,CACxC,OAAQ,CACJ,IAAKC,EACL,EAAGH,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAU,GACV,KAAMC,CACT,CACb,CAAS,EACL,eAAQ,IAAIG,EAAS,IAAI,EACdA,EAAS,IACnB,CClBE,SAASE,EAAaC,EAAK,CAC9B,OAAOA,EACF,IAAIC,GACM;AAAA;AAAA,qBAEE,aAAa;AAAA,wBACV,YAAY,UAAU,IAAI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oCAOd,KAAK;AAAA;AAAA;AAAA;AAAA;AAAA,oCAKL,KAAK;AAAA;AAAA;AAAA;AAAA;AAAA,uCAKF,QAAQ;AAAA;AAAA;AAAA;AAAA;AAAA,wCAKP,SAAS;AAAA;AAAA;AAAA;AAAA,cAKxC,EAAE,KAAK,EAAE,CAElB,CCrBkB,SAAS,eAAe,YAAY,EACtD,MAAMC,EAAa,SAAS,eAAe,aAAa,EACpC,SAAS,cAAc,WAAW,EACtD,MAAMC,EAAgB,SAAS,eAAe,SAAS,EACjDC,EAAc,SAAS,cAAc,gBAAgB,EAE3D,IAAIV,EAAO,EACPW,EAAe,KAEnBH,EAAW,iBAAiB,SAAUI,CAAY,EAElD,SAASC,GAAc,CACrBJ,EAAc,UAAY,EAC5B,CAEAC,EAAY,iBAAiB,QAASI,GAAS,CAC7CA,EAAM,eAAc,EACpBC,GACF,CAAC,EAED,eAAeH,EAAaE,EAAO,CAC/BA,EAAM,eAAc,EACpBL,EAAc,UAAY,GAE1BE,EAAeG,EAAM,cAAc,SAAS,QAAW,MAAM,OAE7D,OAAO,MAAM,QAAU,QAE3B,GAAI,CACA,MAAMX,EAAW,MAAML,EAAUa,EAAcX,CAAI,EAEnD,GAAIG,EAAS,QAAQ,SAAW,EAC5B,OAAOa,EAAS,MAAM,CAClB,QAAS,0EACrB,CAAS,EAEDP,EAAc,UAAYJ,EAAaF,EAAS,OAAO,CAK/D,MAAgB,CAEZa,EAAS,MAAM,CACX,QAAS,0BACjB,CAAS,EACLH,GAEJ,QAAU,CACE,OAAO,MAAM,QAAU,OACvBL,EAAW,MAAK,CAC5B,CAEA,CACgB,IAAIS,EAAe,iBAAkB,CACjC,YAAa,OACb,aAAc,MACd,aAAc,GAClC,CAAC,EAED,eAAeF,GAAiB,CAC9Bf,GAAQ,EACR,GAAI,CACA,MAAMG,EAAW,MAAML,EAAUa,EAAcX,CAAI,EAErD,GAAIG,EAAS,QAAQ,OAAS,EAAG,CAC/BM,EAAc,mBAAmB,YAAaJ,EAAaF,EAAS,OAAO,CAAC,EAK1E,KAAM,CAAC,OAAQe,CAAiB,EAAI,SAAS,cAAc,cAAc,EACxE,kBAAkB,sBAAqB,EAOxC,GALA,OAAO,SAAS,CAChB,IAAKA,EAAoB,EACzB,SAAU,QAClB,CAAS,EACgB,KAAK,KAAKf,EAAS,MAAQ,EAAE,IAC7BH,EACb,OAAAU,EAAY,cAAc,IAAI,WAAW,EAClCM,EAAS,KAAK,CAClB,QAAS,2DACxB,CAAY,CAGZ,MACMA,EAAS,KAAK,CACZ,MAAO,OACP,QAAS,yBACjB,CAAO,EAGC,YAAc,IAAMb,EAAS,UAC/BO,EAAY,MAAM,QAAU,OAC5BM,EAAS,KAAK,CACZ,MAAO,wBACP,QACE,gEACV,CAAO,EAEJ,MAAe,CACdA,EAAS,MAAM,CACb,MAAO,QACP,QACE,uEACR,CAAK,CACF,CACH"}