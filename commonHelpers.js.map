{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\n\nexport async function getPhotos(picture, page) {\n    const BASE_URL = 'https://pixabay.com/api/';\n    const API_KEY = '43303597-4cf3538acd20e5586f11f779c';\n    try {\n        const response = await axios.get(`${BASE_URL}`, {\n            params: {\n                key: API_KEY,\n                q: picture,\n                image_type: 'photo',\n                orientation: 'horizontal',\n                safesearch: true,\n                per_page: 15,\n                page: page,\n            }\n        })\n    \n        return response.data;\n    }\n  \n    catch (error) {\n        console.error(error);\n\n    }\n}\n\n\n","\nexport function createMarkup(arr) {\n    return arr\n      .map(({ largeImageURL, webformatURL, tags, likes, views, comments, downloads }) => {\n            return `\n         <li class=\"galleryCard\">\n          <a href=\"${largeImageURL}\" class=\"lightbox-image\">\n            <img src=\"${webformatURL}\" alt=\"${tags}\" class=\"picture-icon\">\n          </a>\n\n          <div class=\"picture-info\">\n            \n          <div>\n              <span>Likes:</span>\n              <span class=\"likes\">${likes}</span>\n            </div>\n            \n            <div>\n              <span>Views:</span>\n              <span class=\"views\">${views}</span>\n            </div>\n            \n            <div>\n              <span>Comments:</span>\n              <span class=\"comments\">${comments}</span>\n            </div>\n           \n            <div>\n              <span>Downloads:</span>\n              <span class=\"downloads\">${downloads}</span>\n            </div>\n          </div>\n\n        </li>`\n        }).join('');\n\n}\n","`use strict`;\n\n// Library iziToast\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\n// Library SimpleLightbox\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\n// Import функцій\nimport { getPhotos } from \"./js/pixabay-api\";\nimport { createMarkup } from \"./js/render-functions\";\n\n// querySelectors\nconst btnSubmit = document.getElementById(\"search-btn\");\nconst searchForm = document.getElementById(\"search-form\");\nconst searchInput = document.querySelector(\"[picture]\");\nconst searchGallery = document.querySelector(\".gallery\");\nconst loader = document.querySelector(\".loader\");\nconst btnLoadMore = document.querySelector(\".load-more-btn\");\n\n// -------Gallery-------\n\nconst galleryLightbox = new SimpleLightbox('.gallery a', {\n                    captionType: 'attr',\n                    captionsData: 'alt',\n                    captionDelay: 250,\n});\n\nlet page = 1;\nlet currentQuery = \"\";\nlet lastPage = 0;\n// let response = null;\n\nbtnLoadMore.style.display = 'none';\n\nsearchForm.addEventListener(\"submit\", handleSubmit);\n\n//------ очищення вмісту галереї-----\nfunction clearMarkup() {\nsearchGallery.innerHTML = '';\n}\n// ----------------------------------\n\nbtnLoadMore.addEventListener('click', event => {\n  event.preventDefault();\n  handleLoadMore();\n});\n\n// -------Обробка форми та відправлення запиту-------\nasync function handleSubmit(event) {\n    event.preventDefault();\n    searchGallery.innerHTML = '';\n    page = 1;\n   \n    currentQuery = event.currentTarget.elements['picture'].value.trim();\n    loader.style.display = \"block\";\n    \ntry {\n     const response = await getPhotos(currentQuery, page);\n    \n    if (response.hits.length === 0) {\n        btnLoadMore.style.display = 'none';\n        return iziToast.error({\n            message: \"Sorry, there are no images matching your search query. Please try again!\",\n        });\n    } else {\n        searchGallery.innerHTML = createMarkup(response.hits);\n        toggleLoadButton(response);\n\n    }\n     galleryLightbox.refresh(); \n\n} catch (error) {\n    console.error(error);\n} finally {\n            loader.style.display = \"none\";\n            searchForm.reset();\n}\n}\n\n// -------Load More-------\nasync function handleLoadMore() {\n  page += 1;\n  try {\n      const response = await getPhotos(currentQuery, page);\n      \n    if (response.hits.length > 0) {\n      searchGallery.insertAdjacentHTML('beforeend', createMarkup(response.hits));\n        toggleLoadButton(response);\n        galleryLightbox.refresh();\n        \n        // Функія для скролу\n        const {height: galleryCardHeight} = document.querySelector('.galleryCard')\n        .firstElementChild.getBoundingClientRect();\n        window.scrollBy({\n        top: galleryCardHeight * 3,\n        behavior: 'smooth',\n        });\n\n        // -------Last Page-------\n        const lastPage = Math.ceil(response.totalHits / 15);\n        if (lastPage === 0) {\n            btnLoadMore.style.display = 'none';\n           \n        return iziToast.info({\n            message: \"We're sorry, but you've reached the end of search results\"\n        });\n}\n\n    } else {\n      iziToast.info({\n        title: 'Info',\n        message: 'No more images to load!',\n      });\n    }\n      \n//    -------Check--------\n    if (page * 15 >= response.totalHits) {\n      btnLoadMore.style.display = 'none';\n      iziToast.info({\n        title: 'End of search results',\n        message: \"We're sorry, but you're nearing the end of the search results.\",\n      });\n    }\n    } catch (error) {\n      console.error(error);\n    }\n}\n// -------Load More BTN-------\nfunction toggleLoadButton(response) {\n   \n  if (page * 15 < response.totalHits) {\n   btnLoadMore.style.display = 'block';\n\n  }\n  else {\n    btnLoadMore.style.display = 'none';\n      }\n    \n}\n                "],"names":["getPhotos","picture","page","BASE_URL","API_KEY","axios","error","createMarkup","arr","largeImageURL","webformatURL","tags","likes","views","comments","downloads","searchForm","searchGallery","loader","btnLoadMore","galleryLightbox","SimpleLightbox","currentQuery","handleSubmit","event","handleLoadMore","response","iziToast","toggleLoadButton","galleryCardHeight"],"mappings":"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"}