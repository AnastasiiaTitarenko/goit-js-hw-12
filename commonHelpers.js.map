{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\n\nexport async function getPhotos(picture, page) {\n    const BASE_URL = 'https://pixabay.com/api/';\n    const API_KEY = '43303597-4cf3538acd20e5586f11f779c';\n    try {\n        const response = await axios.get(`${BASE_URL}`, {\n            params: {\n                key: API_KEY,\n                q: picture,\n                image_type: 'photo',\n                orientation: 'horizontal',\n                safesearch: true,\n                per_page: 15,\n                page: page,\n            }\n        })\n    \n        return response.data;\n    }\n  \n    catch (error) {\n        console.error(error);\n\n    }\n}\n\n\n","\nexport function createMarkup(arr) {\n    return arr\n      .map(({ largeImageURL, webformatURL, tags, likes, views, comments, downloads }) => {\n            return `\n         <li class=\"galleryCard\">\n          <a href=\"${largeImageURL}\" class=\"lightbox-image\">\n            <img src=\"${webformatURL}\" alt=\"${tags}\" class=\"picture-icon\">\n          </a>\n\n          <div class=\"picture-info\">\n            \n          <div>\n              <span>Likes:</span>\n              <span class=\"likes\">${likes}</span>\n            </div>\n            \n            <div>\n              <span>Views:</span>\n              <span class=\"views\">${views}</span>\n            </div>\n            \n            <div>\n              <span>Comments:</span>\n              <span class=\"comments\">${comments}</span>\n            </div>\n           \n            <div>\n              <span>Downloads:</span>\n              <span class=\"downloads\">${downloads}</span>\n            </div>\n          </div>\n\n        </li>`\n        }).join('');\n\n}\n","`use strict`;\n\n// Library iziToast\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\n// Library SimpleLightbox\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\n// Import функцій\nimport { getPhotos } from \"./js/pixabay-api\";\nimport { createMarkup } from \"./js/render-functions\";\n\n// querySelectors\nconst btnSubmit = document.getElementById(\"search-btn\");\nconst searchForm = document.getElementById(\"search-form\");\nconst searchInput = document.querySelector(\"[picture]\");\nconst searchGallery = document.getElementById(\"gallery\");\nconst loader = document.querySelector(\".loader\");\nconst btnLoadMore = document.querySelector(\".load-more-btn\");\n\nlet page = 1;\nlet currentQuery = null;\nlet response = null;\n\nsearchForm.addEventListener(\"submit\", handleSubmit);\n\n//------ очищення вмісту галереї-----\nfunction clearMarkup() {\n  searchGallery.innerHTML = '';\n}\n// ----------------------------------\n\nbtnLoadMore.addEventListener('click', event => {\n  event.preventDefault();\n  handleLoadMore();\n});\n\n// -------Обробка форми та відправлення запиту-------\nasync function handleSubmit(event) {\n    event.preventDefault();\n    searchGallery.innerHTML = '';\n     gallery.refresh(); \n  \n    currentQuery = event.currentTarget.elements['picture'].value.trim();\n\n    loader.style.display = \"block\";\n    \ntry {\n     response = await getPhotos(currentQuery, page);\n    // console.log(response);\n    \n    if (response.hits.length === 0) {\n        return iziToast.error({\n            message: \"Sorry, there are no images matching your search query. Please try again!\",\n        });\n    } else {\n        searchGallery.innerHTML = createMarkup(response.hits);\n        toggleLoadButton(response);\n        // return response;\n    }\n\n} catch (error) {\n    console.error(error);\n} finally {\n            loader.style.display = \"none\";\n            searchForm.reset();\n}\n}\n// -------Gallery-------\nconst gallery = new SimpleLightbox(`.galleryCard a`, {\n                    captionType: `attr`,\n                    captionsData: `alt`,\n                    captionDelay: 250,\n});\n\n// -------Load More-------\nasync function handleLoadMore() {\n  page += 1;\n  try {\n       response = await getPhotos(currentQuery, page);\n      \n    if (response.hits.length > 0) {\n      searchGallery.insertAdjacentHTML('beforeend', createMarkup(response.hits));\n        toggleLoadButton(response);\n        \n        // Функія для скролу\n        const {height: galleryCardHeight} = document.querySelector('.galleryCard')\n        .firstElementChild.getBoundingClientRect();\n        window.scrollBy({\n        top: galleryCardHeight * 3,\n        behavior: 'smooth',\n        });\n\n        // -------Last Page-------\n        const lastPage = Math.ceil(response.totalHits / 20);\n        if (lastPage === page) {\n            btnLoadMore.classList.add('is-hidden');\n            return iziToast.info({\n            message: \"We're sorry, but you've reached the end of search results\"\n            });\n        }\n\n    } else {\n      iziToast.info({\n        title: 'Info',\n        message: 'No more images to load!',\n      });\n    }\n      \n//    -------Check--------\n    if (page * 20 >= response.totalHits) {\n      btnLoadMore.style.display = 'none';\n      iziToast.info({\n        title: 'End of search results',\n        message: \"We're sorry, but you're nearing the end of the search results.\",\n      });\n    }\n  } catch (error) {\n      console.error(error);\n  }\n}\n// -------Load More BTN-------\nfunction toggleLoadButton(response) {\n    \n  if (page * 20 < response.totalHits) {\n    btnLoadMore.style.display = 'block';\n  } else {\n    btnLoadMore.style.display = 'none';\n  }\n}\n                \n\n\n\n"],"names":["getPhotos","picture","page","BASE_URL","API_KEY","axios","error","createMarkup","arr","largeImageURL","webformatURL","tags","likes","views","comments","downloads","searchForm","searchGallery","loader","btnLoadMore","currentQuery","response","handleSubmit","event","handleLoadMore","gallery","iziToast","toggleLoadButton","SimpleLightbox","galleryCardHeight"],"mappings":"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"}