{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\n\nexport async function getPhotos(picture, page) {\n    const BASE_URL = 'https://pixabay.com/api/';\n    const API_KEY = '43303597-4cf3538acd20e5586f11f779c';\n    try {\n        const response = await axios.get(`${BASE_URL}`, {\n            params: {\n                key: API_KEY,\n                q: picture,\n                image_type: 'photo',\n                orientation: 'horizontal',\n                safesearch: true,\n                per_page: 15,\n                page: page,\n            }\n        })\n    \n        return response.data;\n    }\n  \n    catch (error) {\n        console.error(error);\n\n    }\n}\n\n\n","\nexport function createMarkup(arr) {\n    return arr\n      .map(({ largeImageURL, webformatURL, tags, likes, views, comments, downloads }) => {\n            return `\n         <li class=\"galleryCard\">\n          <a href=\"${largeImageURL}\" class=\"lightbox-image\">\n            <img src=\"${webformatURL}\" alt=\"${tags}\" class=\"picture-icon\">\n          </a>\n\n          <div class=\"picture-info\">\n            \n          <div>\n              <span>Likes:</span>\n              <span class=\"likes\">${likes}</span>\n            </div>\n            \n            <div>\n              <span>Views:</span>\n              <span class=\"views\">${views}</span>\n            </div>\n            \n            <div>\n              <span>Comments:</span>\n              <span class=\"comments\">${comments}</span>\n            </div>\n           \n            <div>\n              <span>Downloads:</span>\n              <span class=\"downloads\">${downloads}</span>\n            </div>\n          </div>\n\n        </li>`\n        }).join('');\n\n}\n","`use strict`;\n\n// Library iziToast\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\n// Library SimpleLightbox\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\n// Import \nimport { getPhotos } from \"./js/pixabay-api\";\nimport { createMarkup } from \"./js/render-functions\";\n\n// querySelectors\nconst btnSubmit = document.getElementById(\"search-btn\");\nconst searchForm = document.getElementById(\"search-form\");\nconst searchInput = document.querySelector(\"[picture]\");\nconst searchGallery = document.getElementById(\"gallery\");\nconst loader = document.querySelector(\".loader\");\nconst btnLoadMore = document.querySelector(\".load-more-btn\");\n\nlet page = 1;\nlet currentQuery = null;\n\nsearchForm.addEventListener(\"submit\", handleSubmit);\n\nfunction clearMarkup() {\n  searchGallery.innerHTML = '';\n}\n\nbtnLoadMore.addEventListener('click', event => {\n  event.preventDefault();\n  handleLoadMore();\n});\n\nasync function handleSubmit(event) {\n    event.preventDefault();\n    searchGallery.innerHTML = '';\n  \n    currentQuery = event.currentTarget.elements['picture'].value.trim();\n\n    loader.style.display = \"block\";\n    \ntry {\n    const response = await getPhotos(currentQuery, page);\n    console.log(response);\n    \n    if (response.hits.length === 0) {\n        return iziToast.error({\n            message: \"Sorry, there are no images matching your search query. Please try again!\",\n        });\n    } else {\n        searchGallery.innerHTML = createMarkup(response.hits);\n        toggleLoadButton(response.hits);\n        return response;\n        gallery.refresh();\n    }\n} catch (error) {\n    console.error(error);\n\n    \n} finally {\n            loader.style.display = \"none\";\n            searchForm.reset();\n}\n\n}\nconst gallery = new SimpleLightbox(`.galleryCard a`, {\n                    captionType: `attr`,\n                    captionsData: `alt`,\n                    captionDelay: 250,\n});\n\nasync function handleLoadMore() {\n  page += 1;\n  try {\n      const response = await getPhotos(currentQuery, page);\n      \n    if (response.hits.length > 0) {\n      searchGallery.insertAdjacentHTML('beforeend', createMarkup(response.hits));\n        toggleLoadButton(response.total);\n        \n        // Функія для скролу\n        \n        const {height: galleryCardHeight} = document.querySelector('.galleryCard')\n        .firstElementChild.getBoundingClientRect();\n      \n        window.scrollBy({\n        top: galleryCardHeight * 3,\n        behavior: 'smooth',\n        });\n        const lastPage = Math.ceil(response.total / 20);\n        if (lastPage === page) {\n            btnLoadMore.classList.add('is-hidden');\n            return iziToast.info({\n               message: \"We're sorry, but you've reached the end of search results\"\n           })\n        }\n\n    } else {\n      iziToast.info({\n        title: 'Info',\n        message: 'No more images to load!',\n      });\n    }\n   \n    if (page * 15 >= response.hits) {\n      btnLoadMore.style.display = 'none';\n      iziToast.info({\n        title: 'End of search results',\n        message:\n          \"We're sorry, but you're nearing the end of the search results.\",\n      });\n    }\n  } catch (error) {\n      console.error(error);\n    // iziToast.error({\n    //   title: 'Error',\n    //   message:\n    //     'An error occurred while fetching more images. Please try again later!',\n    // });\n  }\n}\n\nfunction toggleLoadButton(total) {\n  if (page * 15 < total) {\n    btnLoadMore.style.display = 'block';\n  } else {\n    btnLoadMore.style.display = 'none';\n  }\n}\n                \n\n\n\n"],"names":["getPhotos","picture","page","BASE_URL","API_KEY","axios","error","createMarkup","arr","largeImageURL","webformatURL","tags","likes","views","comments","downloads","searchForm","searchGallery","loader","btnLoadMore","currentQuery","handleSubmit","event","handleLoadMore","response","iziToast","toggleLoadButton","gallery","SimpleLightbox","galleryCardHeight","total"],"mappings":"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"}