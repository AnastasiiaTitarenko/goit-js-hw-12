{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\n\nconst BASE_URL = 'https://pixabay.com/api/';\nconst API_KEY = '43303597-4cf3538acd20e5586f11f779c';\n\nexport async function getPhotos(picture) {\n    try {\n        const response = await axios.get(BASE_URL, {\n            params: {\n                key: API_KEY,\n                q: picture,\n                image_type: 'photo',\n                orientation: 'horizontal',\n                safesearch: true,\n                per_page: 15,\n                page: page,\n            }\n        });\n    \n        return response.hits;\n    }\n    catch (error) {\n        throw new Error(error.response.status);\n    }\n}\n\n\n","\nexport function createMarkup(arr) {\n    return arr\n        .map(item => {\n            return `\n         <li class=\"galleryCard\">\n          <a href=\"${largeImageURL}\" class=\"lightbox-image\">\n            <img src=\"${webformatURL}\" alt=\"${tags}\" class=\"picture-icon\">\n          </a>\n\n          <div class=\"picture-info\">\n            \n          <div>\n              <span>Likes:</span>\n              <span class=\"likes\">${likes}</span>\n            </div>\n            \n            <div>\n              <span>Views:</span>\n              <span class=\"views\">${views}</span>\n            </div>\n            \n            <div>\n              <span>Comments:</span>\n              <span class=\"comments\">${comments}</span>\n            </div>\n           \n            <div>\n              <span>Downloads:</span>\n              <span class=\"downloads\">${downloads}</span>\n            </div>\n          </div>\n\n        </li>`\n        }).join('');\n\n}","`use strict`;\n\n// Library iziToast\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\n// Library SimpleLightbox\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\n// Import \nimport { getPhotos } from \"./js/pixabay-api\";\nimport { createMarkup } from \"./js/render-functions\";\n\n// querySelectors\nconst btnSubmit = document.getElementById(\"search-btn\");\nconst searchForm = document.getElementById(\"search-form\");\nconst searchInput = document.querySelector(\"[picture]\");\nconst searchGallery = document.getElementById(\"gallery\");\nconst btnLoadMore = document.querySelector(\".load-more-btn\");\n\nconst gallery = new SimpleLightbox(`.galleryCard a`, {\n                    captionType: `attr`,\n                    captionsData: `alt`,\n                    captionDelay: 250,\n});\n\nlet currentPage = 1;\nlet currentQuery = '';\n\nsearchForm.addEventListener(\"submit\", handleSubmit);\n\nbtnLoadMore.addEventListener('click', event => {\n  event.preventDefault();\n  handleLoadMore();\n});\nfunction clearMarkup() {\n  gallery.innerHTML = '';\n}\n\nasync function handleSubmit(event) {\n    event.preventDefault();\n  \n    const { picture } = event.currentTarget.elements;\n    currentQuery = picture.value;\n\n    loader.style.display = \"block\";\n\n    clearMarkup();\n    \ntry {\n    const response = await getPhotos(currentQuery, currentPage);\n        \n    if (response.hits.length === 0) {\n        return iziToast.error({\n            message: \"Sorry, there are no images matching your search query. Please try again!\",\n        });\n    } else {\n        searchGallery.innerHTML = createMarkup(response.hits);\n        toggleLoadButton(response.totalHits);\n            gallery.refresh();\n    }\n} catch (error) {\n\n    iziToast.error({\n            title: \"Error\",\n            message: \"Error. Please try again!\"\n            });\n    clearMarkup();\n    \n} finally {\n            loader.style.display = \"none\";\n            searchForm.reset();\n}\n\n}\nasync function handleLoadMore() {\n  currentPage += 1;\n  try {\n    const data = await getPhotos(currentQuery, currentPage);\n    if (data.hits.length > 0) {\n      gallery.insertAdjacentHTML('beforeend', createMarkup(data.hits));\n      togglebtnLoadMore(data.totalHits);\n\n      const galleryCardHeight = document.querySelector('.galleryCard')\n        .getBoundingClientRect().height;\n      window.scrollBy({\n        top: galleryCardHeight * 3,\n        behavior: 'smooth',\n      });\n\n      gallery.refresh();\n    } else {\n      iziToast.info({\n        title: 'Info',\n        message: 'No more images to load!',\n      });\n    }\n   \n    if (currentPage * 15 >= data.totalHits) {\n      btnLoadMore.style.display = 'none';\n      iziToast.info({\n        title: 'End of search results',\n        message:\n          \"We're sorry, but you're nearing the end of the search results.\",\n      });\n    }\n  } catch (error) {\n    iziToast.error({\n      title: 'Error',\n      message:\n        'An error occurred while fetching more images. Please try again later!',\n    });\n  }\n}\n\nfunction toggleLoadButton(totalHits) {\n  if (currentPage * 15 < totalHits) {\n    btnLoadMore.style.display = 'block';\n  } else {\n    btnLoadMore.style.display = 'none';\n  }\n}\n                \n\n\n\n\n"],"names":["BASE_URL","API_KEY","getPhotos","picture","axios","error","createMarkup","arr","item","searchForm","searchGallery","btnLoadMore","gallery","SimpleLightbox","currentPage","currentQuery","handleSubmit","event","handleLoadMore","clearMarkup","response","iziToast","toggleLoadButton","data","galleryCardHeight","totalHits"],"mappings":"owBAEA,MAAMA,EAAW,2BACXC,EAAU,qCAET,eAAeC,EAAUC,EAAS,CACrC,GAAI,CAaA,OAZiB,MAAMC,EAAM,IAAIJ,EAAU,CACvC,OAAQ,CACJ,IAAKC,EACL,EAAGE,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAU,GACV,IACH,CACb,CAAS,GAEe,IACnB,OACME,EAAO,CACV,MAAM,IAAI,MAAMA,EAAM,SAAS,MAAM,CACxC,CACL,CCvBO,SAASC,EAAaC,EAAK,CAC9B,OAAOA,EACF,IAAIC,GACM;AAAA;AAAA,qBAEE,aAAa;AAAA,wBACV,YAAY,UAAU,IAAI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oCAOd,KAAK;AAAA;AAAA;AAAA;AAAA;AAAA,oCAKL,KAAK;AAAA;AAAA;AAAA;AAAA;AAAA,uCAKF,QAAQ;AAAA;AAAA;AAAA;AAAA;AAAA,wCAKP,SAAS;AAAA;AAAA;AAAA;AAAA,cAKxC,EAAE,KAAK,EAAE,CAElB,CCrBkB,SAAS,eAAe,YAAY,EACtD,MAAMC,EAAa,SAAS,eAAe,aAAa,EACpC,SAAS,cAAc,WAAW,EACtD,MAAMC,EAAgB,SAAS,eAAe,SAAS,EACjDC,EAAc,SAAS,cAAc,gBAAgB,EAErDC,EAAU,IAAIC,EAAe,iBAAkB,CACjC,YAAa,OACb,aAAc,MACd,aAAc,GAClC,CAAC,EAED,IAAIC,EAAc,EACdC,EAAe,GAEnBN,EAAW,iBAAiB,SAAUO,CAAY,EAElDL,EAAY,iBAAiB,QAASM,GAAS,CAC7CA,EAAM,eAAc,EACpBC,GACF,CAAC,EACD,SAASC,GAAc,CACrBP,EAAQ,UAAY,EACtB,CAEA,eAAeI,EAAaC,EAAO,CAC/BA,EAAM,eAAc,EAEpB,KAAM,CAAE,QAAAd,CAAS,EAAGc,EAAM,cAAc,SACxCF,EAAeZ,EAAQ,MAEvB,OAAO,MAAM,QAAU,QAEvBgB,IAEJ,GAAI,CACA,MAAMC,EAAW,MAAMlB,EAAUa,EAAcD,CAAW,EAE1D,GAAIM,EAAS,KAAK,SAAW,EACzB,OAAOC,EAAS,MAAM,CAClB,QAAS,0EACrB,CAAS,EAEDX,EAAc,UAAYJ,EAAac,EAAS,IAAI,EACpDE,EAAiBF,EAAS,SAAS,EAC/BR,EAAQ,QAAO,CAE3B,MAAgB,CAEZS,EAAS,MAAM,CACP,MAAO,QACP,QAAS,0BACrB,CAAa,EACTF,GAEJ,QAAU,CACE,OAAO,MAAM,QAAU,OACvBV,EAAW,MAAK,CAC5B,CAEA,CACA,eAAeS,GAAiB,CAC9BJ,GAAe,EACf,GAAI,CACF,MAAMS,EAAO,MAAMrB,EAAUa,EAAcD,CAAW,EACtD,GAAIS,EAAK,KAAK,OAAS,EAAG,CACxBX,EAAQ,mBAAmB,YAAaN,EAAaiB,EAAK,IAAI,CAAC,EAC/D,kBAAkBA,EAAK,SAAS,EAEhC,MAAMC,EAAoB,SAAS,cAAc,cAAc,EAC5D,sBAAqB,EAAG,OAC3B,OAAO,SAAS,CACd,IAAKA,EAAoB,EACzB,SAAU,QAClB,CAAO,EAEDZ,EAAQ,QAAO,CACrB,MACMS,EAAS,KAAK,CACZ,MAAO,OACP,QAAS,yBACjB,CAAO,EAGCP,EAAc,IAAMS,EAAK,YAC3BZ,EAAY,MAAM,QAAU,OAC5BU,EAAS,KAAK,CACZ,MAAO,wBACP,QACE,gEACV,CAAO,EAEJ,MAAe,CACdA,EAAS,MAAM,CACb,MAAO,QACP,QACE,uEACR,CAAK,CACF,CACH,CAEA,SAASC,EAAiBG,EAAW,CAC/BX,EAAc,GAAKW,EACrBd,EAAY,MAAM,QAAU,QAE5BA,EAAY,MAAM,QAAU,MAEhC"}